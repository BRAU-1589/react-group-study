13.4 URL 파라미터와 쿼리

특징
파라미터
/profiles/velopert
특정 아이디 혹은 이름을 사용해 조회
쿼리
/about?details=true
어떤 키워드 검색하거나 페이지에 필요한 옵션을 전달

13.4.1 URL 파라미터

profile이라는 컴포넌트를 만들어 props로 특정 값을 받아 조회하는 코드를 작성하면 아래와 같습니다.

// Profile.js 파일

import React from ‘react‘;

const data = {
velopert: {
name: '김지민',
description: '리액트를 시도하는 중 ...'
},
gildong: {
name: '홍길동',
description: '고전 소설 홍길동전의 주인공'
}
};

const Profile = ({ match }) => {
const { username } = match.params;
const profile = data[username];
if (!profile) {
return <div>존재하지 않는 사용자입니다.</div>;
}
return (
<div>
<h3>
{username}({profile.name})
</h3>
<p>{profile.description}</p>
</div>
);
};

export default Profile;

그리고 app.js 파일도 수정해 주는데, 위에 작성한 profile 컴포넌트를 위한 라우터를 정의하기 위해서입니다. username 값을 조회할 수 있다는 특징을 가집니다. 또 페이지 상단에 각 프로필 페이지로 이동하는 링크도 달기 위해 import문을 작성합니다.

// App.js 파일

import React from 'react';
import { Route, Link } from 'react-router-dom';
import About from './About';
import Home from './Home';
import Profile from './Profile';

const App = () => {
return (
<div>
<ul>
<li>
<Link to="/">홈</Link>
</li>
<li>
<Link to="/about">소개</Link>
</li>
<li>
<Link to="/profile/velopert">velopert 프로필</Link>
</li>
<li>
<Link to="/profile/gildong">gildong 프로필</Link>
</li>
</ul>
<hr />
<Route path="/" component={Home} exact={true} />
<Route path={['/about', '/info']} component={About} />
<Route path="/profile/:username" component={Profile} />
</div>
);
};

export default App;

13.4.2 URL 쿼리

About 페이지에서 location 객체에 들어있는 search 값에서 쿼리를 조회합니다.

location의 형태
http://localhost:3000/about?detail=true 주소로 들어갈 때의 location 객체

{
“pathname”: “/about”,
“search”: “?detail=true”,
“hash”: “ ”
}

URL 쿼리를 읽을 때는 위 객체가 지닌 값 중에서 search 값을 확인해야 하는데, 이건 문자열 형태로 되어 있습니다. URL 쿼리는? detail=true&another=1과 같이 문자열에 여러 가지 값을 설정해 줄 수 있습니다. search 값에서 특정 값을 읽어 오기 위해서는 이 문자열을 객체 형태로 변환해야 합니다.

쿼리 문자열을 객체로 변환할 때는 qs라는 라이브러리를 사용하는데, 아래의 코드를 이용해 라이브러리를 설치합니다.

$ yarn add qs

그러면 이제 About 컴포넌트에서 location.search 값에 있는 detail이 true인지 아닌지에 따라 추가 정보를 보여주게 수정하면 아래와 같습니다.

// About.js 파일
import React from 'react';
import qs from 'qs';

const About = ({ location }) => {
const query = qs.parse(location.search, {
ignoreQueryPrefix: true // 이 설정을 통해 문자열 맨 앞의 ?를 생략합니다.
});
const showDetail = query.detail === 'true'; // 쿼리의 파싱 결과 값은 문자열입니다.
return (
<div>
<h1>소개</h1>
<p>이 프로젝트는 리액트 라우터 기초를 실습해 보는 예제 프로젝트입니다.</p>
{showDetail && <p>detail 값을 true로 설정하셨군요!</p>}
</div>
);
};
export default About;

쿼리를 사용할 때, 쿼리 문자열을 객체로 파싱하는 과정에서 결과 값은 언제나 문자열이다. value=1 혹은? value=true와 같이 숫자나 논리 자료형을 사용한다고 우리가 원하는 형태로 변환되는 것이 아니라, "1", "true"와 같이 문자열 형태로 받아집니다. 그렇기에 숫자를 원하면 parseInt 함수를 통해 숫자로 변환하고, 논리 자료형 값을 사용해야 하는 경우에는 "true" 문자열이랑 일치하는지 비교해 확인해야 한다.
