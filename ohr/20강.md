# 20.1 서버 사이드 렌더링의 이해
## CSR(클라이언트 사이드 렌더링)
- 클라이언트 측에서 렌더링을 하는 방식
- **최초에 한번 서버에서 전체 페이지를 로딩하여** 보여주고 이후에는 사용자의 요청이 올 때마다 리소스를 서버에서 제공한 후 클라이언트가 해석하고 렌더링을 하는 방식

### 장점
1. 자바스크립트만으로 전체 페이지를 구성할 수 있어서 동적으로 화면을 구성가능
2. 컴포넌트 단위로 코드를 나누어 관리할 수 있고, 다양한 디자인 패턴을 적용할 수 있어 개발의 유연성이 높음
3. 전체 페이지를 다시 불러오지 않고도 **필요한 부분만 업데이트**할 수 있어 사용자 경험을 향상

### 단점
1. 검색 엔진 최적화(SEO)에 취약 : 서버에서 전달되는 페이지가 동적으로 생성되기 때문에 검색 엔진이 페이지를 색인화하기 어려움
2. 초기 로딩 시 모든 로직이 담긴 자바스크립트 파일을 다운로드해야 하기 때문에 초기 로딩 속도가 느릴 수 있다.

### 이러한 단점을 보완하는 방법
1. 번들 크기 최적화 : 코드 스플리팅, 트리 쉐이킹 등을 사용하여 자바스크립트 번들의 크기를 줄여 초기 로딩 시간을 단축시키기
2. 프리 렌더링 (Pre-rendering): 각 페이지에 대한 HTML 파일을 사전에 생성하여 서버에서 요청 시 렌더링된 HTML 페이지를 바로 제공하기.
3. 서버 사이드 렌더링 (SSR) 또는 정적 사이트 생성 (SSG) 도입
: 프레임워크 없이도 도입이 가능하나, 진입장벽이 크다. next.js,nuxt.js,gatsby 등 다양한 프레임워크를 통해 ssr를 도입할 수 있다.

## SSR(서버 사이드 렌더링)
클라이언트 요청에 대해 서버 측에서 초기 HTML을 생성하고 전송하는 방식

### 장점
1. 검색 엔진 최적화(SEO) 개선: 초기 HTML이 서버에서 생성되기 때문에 검색 엔진이 콘텐츠를 쉽게 읽고 색인화 가능
2. 초기 로딩 속도 개선: 사용자가 페이지를 요청할 때마다 서버에서 HTML을 생성하므로 초기 로딩 속도가 향상됨
3. 소셜 미리보기 개선: 소셜 미리보기를 제공하기 위해 메타 데이터가 포함된 초기 HTML을 제공가능

### 단점
1. 서버 부하 증가: 매 요청마다 서버에서 HTML을 생성해야 하므로 서버 부하가 증가함
2. 캐싱 어려움: 동적으로 생성된 HTML을 캐싱하기 어려워 캐싱 전략을 구현하기 어려울 수 있음
3. 페이지 전환 시 깜빡임: 클라이언트 측에서 새로운 HTML을 받아오는 동안 페이지가 새로고침되는 것처럼 보이는 깜빡임이 발생
4. 중복된 내용 재렌더링: Header나 Footer와 같이 페이지 이동 시에도 유지되는 중복된 내용들도 새로 받아와야 하기 때문에 리소스 낭비

## SSG(스테틱 사이트 제너레이션)
클라이언트에서 웹사이트의 모든 페이지를 미리 만들어 놓고, 사용자가 요청할 때마다 보여주는 방식

모든 페이지가 이미 만들어져 있기 때문에 사용자가 요청할 때마다 서버가 새로운 페이지를 만들 필요가 없고, 검색 엔진이 이해하기 쉽다. 그러나 변경이 자주 일어나는 동적인 콘텐츠에는 적합하지 않다.

> 예를 들어, 블로그를 만든다고 가정하면, 새로운 글을 쓸 때마다 그 글에 해당하는 페이지를 미리 만들어놓고, 사용자가 그 페이지를 요청할 때마다 미리 만들어놓은 페이지를 그대로 보여주는 것이다. 이런 방식을 정적 사이트 생성이라고 한다.


### SSR과 SSG의 차이점은?
서버에서 요청할 때 **즉시만드느냐** or **미리 만들어 놓느냐**에 따라 차이가 있다.

SSR은 요청시 서버에서 즉시 HTML을 만들어서 응답하기 때문에 데이터가 달라져서 미리 만들어 두기 어려운 페이지에 적합하다.

반면 SSG 미리 다 만들어두고 요청시에 해당 페이지를 응답하기 때문에 바뀔일이 거의없어서 캐싱해두면 좋은 페이지에 사용된다.


## 사용용도에 따른 방식
> 유저랑 상호작용이 많고 고객의 개인정보로 기준으로 이루어지는 서비스라면 검색엔진 노출보다 고객의 데이터를 보호하는 것이 더 중요할 수 있다 -> CSR

> 회사홈페이지이기 때문에 상위노출이 필요하고 누구에게나 항상 같은 내용을 보여줘야하며 매주 업데이트 되어야한다면 ->SSR

> 회사홈페이지이기 때문에 상위노출이 필요하고 누구에게나 항상 같은 내용을 보여줘야 하지만 업데이트를 거의 하지 않아도 된다면 -> SSG

> 만약 사용자에 따라 페이지 내용이 달라지며 화면깜빡임 없는 빠른 인터렉션이 중요하고 상위노출이 필요하다면 -> CSR + SSR = Universal랜더링을 고려

## SSR과 코드 스플리팅 충돌
SSR과 코드 스플리팅은 각각 원리와 동작이 서로 다르기 때문에 두 기술을 함께 사용하려면 추가적인 설정과 작업이 필요힌데,  코드 스플리팅을 SSR과 조합하면 서버와 클라이언트 간의 라우팅을 조율해야 하고, 동일한 코드를 서버와 클라이언트에서 사용할 수 있도록 해야하기 때문에, 이로 인해 개발 및 유지 보수가 좀 더 복잡해진다.

>코드 스플리팅 : 클라이언트 측에서 자바스크립트 파일을 여러 개로 분할하여 필요한 부분만 로드하는 기술

또한 페이지를 서버에서 렌더링하고, 클라이언트 측에서 자바스크립트 파일을 다운로드하고 실행하는 과정에서 페이지가 다시 렌더링되면서 깜빡임이 발생할 수 있다.

이러한 이슈를 해결하려면 라우트 경로마다 코드 스플리팅된 파일 중에서 필요한 모든 파일을 브라우저에서 렌더링하기 전에 **미리** 불러와한다.

> 참고링크:  https://velog.io/@ka0son/%EB%A0%8C%EB%8D%94%EB%A7%81-%EC%82%BC%ED%98%95%EC%A0%9C-CSR-SSR-SSG-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0